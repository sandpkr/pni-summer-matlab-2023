clear
clc
close all

velocity_array=[];
stimulus_array=[];

for i=1:50
    velocity_array_sample=[0.16887537	0.17070776	0.17320168	0.17427035	0.17675799	0.17844930	0.17845730	0.17813872	0.17793912	0.17752412	0.17791483	0.17773877	0.17765948	0.17720971	0.17696773	0.17736532	0.17776006	0.17821406	0.17885119	0.17858115	0.17811935	0.17755075	0.17709973	0.17662866	0.17598030	0.17520073	0.17429331	0.17352405	0.17281836	0.17205149	0.17104588	0.16988051	0.16856545	0.16714866	0.16545612	0.16374539	0.16159187	0.15945834	0.15711823	0.15486987	0.15233783	0.14967500	0.14685400	0.14398398	0.14094439	0.13799417	0.13456969	0.13087338	0.12704387	0.12342646	0.11974180	0.11598130	0.11245667	0.10898146	0.10556038	0.10246268	0.099882096	0.097517818	0.095277429	0.093329459	0.091587581	0.090141997	0.088912211	0.087924458	0.086870953	0.086239129	0.085847005	0.085624516	0.085540324	0.085869633	0.085768975	0.086001933	0.086310469	0.086998440	0.087951183	0.089183941	0.090609372	0.092206612	0.093562014	0.095025450	0.096540026	0.098292932	0.10055871	0.10230172	0.10348903	0.10453632	0.10531501	0.10627133	0.10730971	0.10787682	0.10901330	0.10738485	0.10788035	0.10841572	0.10904985	0.10968754	0.11020265	0.11097182	0.11191427	0.11114682	0.11275241	0.11136749	0.11026654	0.10767974	0.10542901	0.10288678	0.10063838	0.098609947	0.095435284	0.091571659	0.088843510	0.086693004	0.086147480	0.085220382	0.084806085	0.084773816	0.083763197	0.086722314	0.089686885	0.092883207	0.095616065	0.10060861	0.10514128	0.10909463	0.11339414	0.11871202	0.12291709	0.12760134	0.13142538	0.13510790	0.13551933	0.13677715	0.13808003	0.13872752	0.13873412	0.13752034	0.13528197	0.13299383	0.12999186	0.12697886	0.12312838	0.11862118	0.11261468	0.10608698	0.098885864	0.091590956	0.083484940	0.074746303	0.065240890	0.054887366	0.043943498	0.032494821	0.020305999	0.0075287949	-0.0057653133	-0.019583598	-0.033857606	-0.048302080	-0.062861755	-0.077665426	-0.092461094	-0.10703844	-0.12139811	-0.13552549	-0.14922135	-0.16245623	-0.17510518	-0.18737215	-0.19892299	-0.20985147	-0.22039343	-0.22849035	-0.23739240	-0.24470854	-0.25053412	-0.25598016	-0.26011375	-0.26541841	-0.26902789	-0.27197784	-0.27564245	-0.27849439	-0.28180924	-0.28570396	-0.28983486	-0.29403061	-0.29595810	-0.29894286	-0.30141881	-0.30363455	-0.30459264	-0.30521399	-0.30524367	-0.30382836	-0.30241162	-0.30038834	-0.29784650	-0.29373837	-0.29054543	-0.28670648	-0.28249362	-0.27719650	-0.27340919	-0.26872864	-0.26432902	-0.25901276	-0.25623482	-0.25308070	-0.24994715	-0.24742438	-0.24562916	-0.24165292	-0.23881106	-0.23579228	-0.23333354	-0.22941656	-0.22474755	-0.21946211	-0.21334709	-0.20529968	-0.19934896	-0.19171691	-0.18396798	-0.17455900	-0.16447057	-0.15278126	-0.14139985	-0.13016760	-0.12018747	-0.10927509	-0.098934144	-0.088598356	-0.079834551	-0.071659207	-0.065054327	-0.058516569	-0.051838823	-0.045698196	-0.038856674	-0.032248013	-0.025634656	-0.019013721	-0.012415949	-0.0059594307	0.00045789289	0.0067575183	0.013059238	0.019265426	0.025534067	0.031878304	0.038590413	0.045711979	0.052989449	0.059012786	0.066174574	0.072980180	0.079810023	0.087174267	0.094779097	0.10020070	0.10704811	0.11334946	0.12036032	0.12663667	0.13294898	0.13932183	0.14340237	0.14774071	0.15495116	0.15988119	0.16508295	0.17047465	0.17516315	0.17957263	0.18380702	0.18887903	0.19215292	0.19392110	0.19625440	0.19853704	0.20106798	0.20249318	0.20339203	0.20410924	0.20546961	0.20805547	0.21041170	0.21224071	0.21416305	0.21495302	0.21671204	0.22017178	0.22401515	0.22758846	0.23060817	0.23360418	0.23710680	0.24017863	0.24402401	0.24751325	0.25014326];
    random_noise = 0.03*rand(size(velocity_array_sample))+0.1*randn;
    
    stimulus_array_sample = zeros(size(velocity_array_sample));
    index = randperm(length(stimulus_array_sample),1);
    stimulus_array_sample(index) = randi([2 5],1);

    velocity_array(i,:)=velocity_array_sample+random_noise;
    stimulus_array(i,:)=stimulus_array_sample;

end

% % % for i=1:50
% % %     plot(velocity_array(i,:))
% % %     ylim([-0.5 0.5])
% % %     waitforbuttonpress                  
% % %     close all
% % % end

disp('Analysis finished')